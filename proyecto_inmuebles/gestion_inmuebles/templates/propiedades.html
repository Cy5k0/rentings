{% extends 'layout/base.html' %}


{% block content %}
{% load static %}


<h2>Mis Inmuebles</h2>
<a href="{% url 'agregar_propiedad' %}">Agregar Inmuebles</a>
<ul>
    {% for item in inmuebles_con_imagenes %}
    <li>
        <strong>{{ item.tipoinmueble.nombre }}</strong>
        {% if not item.inmueble.disponible  %}
        <br>
        <strong>Ocupada</strong>
        <form action="{% url 'habilitar_request' item.inmueble.pk %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-success btn-sm">Habilitar Nuevamente</button>
        </form>
        {% else %}
        <br>
        <strong>Disponible</strong>
        {% endif %}
        <br>
        <strong>{{ item.inmueble.nombre }}</strong> - {{ item.inmueble.descripcion }} - {{ item.inmueble.precio }} {{ item.inmueble.moneda }}
        <br>
        Dirección: {{ item.inmueble.calle }} {{ item.inmueble.numero }}, {{ item.inmueble.ciudad.nombre }}
        <br>
        m2 construidos:  {{ item.inmueble.m2_construidos }} - m2 totales : {{ item.inmueble.m2_totales }}
        <br>
        estacionamientos : {{ item.inmueble.n_estacionamientos }}
        <br>
        habitaciones : {{ item.inmueble.n_habitaciones }} -  baños : {{ item.inmueble.n_baños }}
        {% comment %} {{item.inmueble.pk}} {% endcomment %}
        <br><a href="{% url 'mostrar_un_inmuebles' item.inmueble.pk  %}">Modificar Inmuebles</a>--<a href="{% url 'mostrar_un_inmuebles' item.inmueble.pk  %}">Agregar Fotografia</a>
        <!-- Carrusel de imágenes en miniatura -->

        {% if item.imagenes %}
            <div class="row">
                
                {% for imagen in item.imagenes %}
                    <!-- para manipular un contador de elementos y saber donde agregar fila-->
                    {% if forloop.counter0|divisibleby:4 and not forloop.first %}
                        </div><div class="row">
                    {% endif %}
                    <div class="col-sm-6 mb-3 mb-sm-0">
                    <div class="card">
                        <div class="card-body">
                        <h5 class="card-title">Foto {{ i }}</h5>
                        <img id="prop-min" src="{{ imagen.imagen.url }}" class="d-block w-auto"  alt="Imagen de {{ item.inmueble.nombre }}">
                        <a href="#" class="btn btn-primary">Eliminar Foto</a>
                        </div>
                    </div>
                    </div>
                   
                {% endfor %}    
  
            </div>

        {% else %}
        <p>Imágenes no disponibles</p>
        {% endif %}
    </li>
    {% endfor %}
</ul>


{% endblock %}